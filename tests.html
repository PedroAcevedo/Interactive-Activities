<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link
     href='http://fonts.googleapis.com/css?family=Roboto:300,700' 
     rel='stylesheet' 
     type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Montserrat&amp;display=swap" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/timer.js"></script>
    <title></title>
  </head>
  <style type="text/css">
    body {
    font-family: 'Roboto', sans-serif;
    }

    .container_box{
      display: flex;
      justify-content: center;
      flex-direction: column;
      flex-wrap: wrap;  
    }

    .container_flex{
      display: flex;
      justify-content: flex-start;
      flex-direction: row;
      flex-wrap: wrap;  
    }

    .container_flex .title{
      margin: 0;
      text-align: left;
      font-size: 40px;
    }

    .container_box #timer{
      text-align: right;
      font-size: 20px;
    }

    .question_box{
      padding: 10px 20px 10px 20px;
      text-align: justify;
    }

    .question_box p {
      padding: 0px 30px 0px 30px;
    }
    .question_box li {
      margin-bottom: 15px; 
      padding-right: 30px;
    }

    .button_sumit{
      font-family: inherit;
      background-color: #004BB5;
      color: white;
      font-size: 20px;
      text-align: center;
      margin: 0px 30% 0px 30%;
    }

    ul {
      list-style-type: none;
    }
  </style>
  <script type="text/javascript">

    var num_questions = 0;
    var intervalID;
    var questions = []
    var index = 1;

    fetch('https://api.myjson.com/bins/cptzs')
      .then(response => response.json())
      .then(function (json) {
        console.log(json)
        
        questions = json['questions'];
        var title_timer = "<section class=\"title\"><h1>Test</h1></section> <div id=\"timer\">00:00</div>";
        var results = '';
        num_questions = questions.length;
        const {id, content, options} = questions.pop();
        results += `
          <section class="question_box">
              <p class="question_description">
                ${index}. ${content}
              </p>
            <ul>`
        options.forEach((option) => {
          results += `
              <li><input type="radio" name="option ${index}" value="${option}">
                ${option}
              </li>       
          `
        });
        results += '</ul></section>'
        index = index + 1;          
        document.getElementById('results').innerHTML = results;
        document.getElementById('title_results').innerHTML = title_timer;
        document.getElementById('sendData').addEventListener('click', sendData);
    });

  function sendData(){
    var results = '';
    
/*    for (var i = 0; i < 1;i++) {
      console.log(document.querySelector('input[name="option '+i+'"]:checked').value)
    }*/

    if (questions.length > 0) {
      const {id, content, options} = questions.pop();
        results += `
          <section class="question_box">
              <p class="question_description">
                ${index}. ${content} pipi
              </p>
            <ul>`
        options.forEach((option) => {
          results += `
              <li><input type="radio" name="option ${index}" value="${option}">
                ${option}
              </li>       
          `
        });
        results += '</ul></section>'
        index = index +1;          
        document.getElementById('results').innerHTML = results;
    }

    /*
    json {
      userID:
      activity:
      time_to_finish:
      questions: [
        {
          questionID: ID
          answer: 0-1-2-3
        }
      ]
    }
    */

  }

  var intervalID = setInterval(function(){
      console.log('Hola');
      $("#timer").text(function() {
        var timer = showTime(5);
        if (timer.localeCompare('02:00')==-1){
          $("#timer").css("color", "red");
        }
        if (timer.localeCompare('end')==0) {
          clearTimeout(intervalID);
        }
        return timer;
      });

    }, 1000);
  </script>
  <body>
      <section class="container_box" >
        <section class="container_flex">
          <section id="title_results"></section>
        </section>
        <section id="results" ></section>
        <input id="sendData" class="button_sumit" type="submit" value="Enviar">
      </section>
  </body>
</html>
